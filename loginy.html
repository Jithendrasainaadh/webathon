<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>KisanAI â€“ Farmer Advisory System</title>
<link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:wght@500;600;700&family=Outfit:wght@300;400;500;600&display=swap" rel="stylesheet"/>
<link rel="stylesheet" href="loginstyle.css">
</head>
<body>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     REALISTIC PHOTO SLIDESHOW BACKGROUND
     â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="slideshow" id="slideshow">
  <div class="slide slide-1 active"></div>
  <div class="slide slide-2"></div>
  <div class="slide slide-3"></div>
  <div class="slide slide-4"></div>
  <div class="slide slide-5"></div>
  <div class="slide slide-6"></div>
</div>

<!-- Layered overlays for cinematic depth -->
<div class="slide-overlay"></div>
<div class="vignette"></div>
<div class="grain"></div>

<!-- Scene label -->
<div class="scene-label" id="scene-label">Golden Wheat Fields</div>

<!-- Dot navigation -->
<div class="slide-dots" id="dots"></div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     MAIN PAGE
     â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="page">

  <!-- Logo -->
  <div class="logo">
    <div class="logo-badge">ğŸŒ¾</div>
    <div class="logo-text">
      <span class="logo-name">KisanAI</span>
      <span class="logo-sub">Farmer Advisory System</span>
    </div>
  </div>

  <!-- Card -->
  <div class="card">

    <div class="tabs">
      <button class="tab active" id="t-login"    onclick="show('login')">Login</button>
      <button class="tab"        id="t-register" onclick="show('register')">Register</button>
    </div>

    <!-- â”€â”€ LOGIN â”€â”€ -->
    <div class="panel active" id="p-login">
      <h2 class="form-title">Welcome back, Kisan ğŸ‘‹</h2>
      <p  class="form-sub">Sign in to get today's farming advisory</p>

      <div class="field" id="f-lg-id">
        <label>Phone / Email</label>
        <div class="irow">
          <span class="ico">ğŸ“±</span>
          <input type="text" id="lg-id" placeholder="Enter phone or email" autocomplete="username"/>
        </div>
        <span class="errmsg" id="e-lg-id"></span>
      </div>

      <div class="field" id="f-lg-pw">
        <label>Password</label>
        <div class="irow">
          <span class="ico">ğŸ”’</span>
          <input type="password" id="lg-pw" placeholder="Enter your password" autocomplete="current-password"/>
          <button class="eye" onclick="toggleEye('lg-pw',this)">ğŸ‘ï¸</button>
        </div>
        <span class="errmsg" id="e-lg-pw"></span>
      </div>

      <div class="meta">
        <label class="chklbl"><input type="checkbox" id="remember"/> Remember me</label>
        <a href="#" class="lnk" onclick="show('forgot');return false">Forgot password?</a>
      </div>

      <button class="btn" id="btn-login" onclick="doLogin()">
        <span id="btl-txt">Login</span>
      </button>

      <div class="divider"><span>or continue with</span></div>

      <div class="socials">
        <button class="sbtn" onclick="social('Google')">
          <svg width="16" height="16" viewBox="0 0 48 48">
            <path fill="#4285F4" d="M44.5 20H24v8.5h11.7C34.6 33 29.8 36 24 36c-6.6 0-12-5.4-12-12s5.4-12 12-12c3 0 5.7 1.1 7.8 2.9l6-6C34.4 6.1 29.5 4 24 4 12.9 4 4 12.9 4 24s8.9 20 20 20c11 0 19.7-8 19.7-20 0-1.3-.1-2.7-.2-4z"/>
            <path fill="#34A853" d="M6.3 14.7l7 5.1C15 16.1 19.1 13 24 13c3 0 5.7 1.1 7.8 2.9l6-6C34.4 6.1 29.5 4 24 4 16.2 4 9.4 8.4 6.3 14.7z"/>
            <path fill="#FBBC05" d="M24 44c5.7 0 10.5-1.9 14.1-5.1l-6.5-5.3C29.7 35.6 27 36.5 24 36.5c-5.7 0-10.6-3.9-12.3-9.1l-7 5.4C8 38.4 15.4 44 24 44z"/>
            <path fill="#EA4335" d="M44.5 20H24v8.5h11.7c-.9 2.5-2.6 4.6-4.9 6.1l6.5 5.3c3.8-3.5 6.2-8.7 6.2-14.9 0-1.3-.1-2.7-.2-4z"/>
          </svg>
          Google
        </button>
        <button class="sbtn" onclick="social('Facebook')">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="#1877F2">
            <path d="M24 12.073C24 5.405 18.627 0 12 0S0 5.405 0 12.073C0 18.1 4.388 23.094 10.125 24v-8.437H7.078v-3.49h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.49h-2.796V24C19.612 23.094 24 18.1 24 12.073z"/>
          </svg>
          Facebook
        </button>
      </div>
    </div>

    <!-- â”€â”€ REGISTER â”€â”€ -->
    <div class="panel" id="p-register">
      <h2 class="form-title">Join KisanAI ğŸŒ±</h2>
      <p  class="form-sub">Create your free farmer account</p>

      <div class="row2">
        <div class="field" id="f-rg-fn">
          <label>First Name</label>
          <div class="irow">
            <span class="ico">ğŸ‘¤</span>
            <input type="text" id="rg-fn" placeholder="First name"/>
          </div>
          <span class="errmsg" id="e-rg-fn"></span>
        </div>
        <div class="field" id="f-rg-ln">
          <label>Last Name</label>
          <div class="irow">
            <input type="text" id="rg-ln" placeholder="Last name" style="padding-left:0.9rem"/>
          </div>
          <span class="errmsg" id="e-rg-ln"></span>
        </div>
      </div>

      <div class="field" id="f-rg-ph">
        <label>Phone Number</label>
        <div class="irow">
          <span class="ico">ğŸ“±</span>
          <input type="tel" id="rg-ph" placeholder="+91 98765 43210"/>
        </div>
        <span class="errmsg" id="e-rg-ph"></span>
      </div>

      <div class="field" id="f-rg-em">
        <label>Email Address</label>
        <div class="irow">
          <span class="ico">âœ‰ï¸</span>
          <input type="email" id="rg-em" placeholder="youremail@example.com"/>
        </div>
        <span class="errmsg" id="e-rg-em"></span>
      </div>

      <div class="row2">
        <div class="field" id="f-rg-st">
          <label>State</label>
          <div class="irow">
            <span class="ico">ğŸ“</span>
            <select id="rg-st">
              <option value="">Select State</option>
              <option>Punjab</option><option>Haryana</option>
              <option>Uttar Pradesh</option><option>Maharashtra</option>
              <option>Rajasthan</option><option>Madhya Pradesh</option>
              <option>Gujarat</option><option>Karnataka</option>
              <option>Andhra Pradesh</option><option>Tamil Nadu</option>
              <option>West Bengal</option><option>Bihar</option>
              <option>Odisha</option><option>Telangana</option>
              <option>Other</option>
            </select>
          </div>
          <span class="errmsg" id="e-rg-st"></span>
        </div>
        <div class="field" id="f-rg-cr">
          <label>Primary Crop</label>
          <div class="irow">
            <span class="ico">ğŸŒ¾</span>
            <select id="rg-cr">
              <option value="">Select Crop</option>
              <option>Wheat</option><option>Rice / Paddy</option>
              <option>Cotton</option><option>Maize</option>
              <option>Sugarcane</option><option>Soybean</option>
              <option>Mustard</option><option>Groundnut</option>
              <option>Tomato</option><option>Onion</option>
              <option>Potato</option><option>Other Vegetables</option>
            </select>
          </div>
          <span class="errmsg" id="e-rg-cr"></span>
        </div>
      </div>

      <div class="field">
        <label>Preferred Language</label>
        <div class="irow">
          <span class="ico">ğŸŒ</span>
          <select id="rg-lg">
            <option value="">Select Language</option>
            <option value="en">English</option>
            <option value="hi">à¤¹à¤¿à¤‚à¤¦à¥€ (Hindi)</option>
            <option value="pa">à¨ªà©°à¨œà¨¾à¨¬à©€ (Punjabi)</option>
            <option value="mr">à¤®à¤°à¤¾à¤ à¥€ (Marathi)</option>
            <option value="gu">àª—à«àªœàª°àª¾àª¤à«€ (Gujarati)</option>
            <option value="kn">à²•à²¨à³à²¨à²¡ (Kannada)</option>
            <option value="ta">à®¤à®®à®¿à®´à¯ (Tamil)</option>
            <option value="te">à°¤à±†à°²à±à°—à± (Telugu)</option>
            <option value="bn">à¦¬à¦¾à¦‚à¦²à¦¾ (Bengali)</option>
          </select>
        </div>
      </div>

      <div class="field" id="f-rg-pw">
        <label>Password</label>
        <div class="irow">
          <span class="ico">ğŸ”’</span>
          <input type="password" id="rg-pw" placeholder="Min 8 characters" oninput="strength(this.value)"/>
          <button class="eye" onclick="toggleEye('rg-pw',this)">ğŸ‘ï¸</button>
        </div>
        <div class="sbar"><div class="sfill" id="sfill"></div></div>
        <span class="slbl" id="slbl"></span>
        <span class="errmsg" id="e-rg-pw"></span>
      </div>

      <div class="field" id="f-rg-cp">
        <label>Confirm Password</label>
        <div class="irow">
          <span class="ico">ğŸ”</span>
          <input type="password" id="rg-cp" placeholder="Re-enter password"/>
          <button class="eye" onclick="toggleEye('rg-cp',this)">ğŸ‘ï¸</button>
        </div>
        <span class="errmsg" id="e-rg-cp"></span>
      </div>

      <label class="termsrow">
        <input type="checkbox" id="terms"/>
        <span>I agree to the <a href="#" class="lnk">Terms &amp; Conditions</a> and <a href="#" class="lnk">Privacy Policy</a></span>
      </label>

      <button class="btn" id="btn-reg" onclick="doRegister()">
        <span id="btr-txt">Create Account</span>
      </button>
    </div>

    <!-- â”€â”€ FORGOT â”€â”€ -->
    <div class="panel" id="p-forgot">
      <button class="back" onclick="show('login')">â† Back to Login</button>
      <h2 class="form-title">Reset Password ğŸ”‘</h2>
      <p  class="form-sub">Enter your registered phone or email to receive a reset link</p>

      <div class="field" id="f-fp-id">
        <label>Phone / Email</label>
        <div class="irow">
          <span class="ico">ğŸ“±</span>
          <input type="text" id="fp-id" placeholder="Registered phone or email"/>
        </div>
        <span class="errmsg" id="e-fp-id"></span>
      </div>

      <button class="btn" id="btn-fp" onclick="doForgot()">
        <span id="btf-txt">Send Reset Link</span>
      </button>
    </div>

  </div><!-- /card -->

  <!-- Language bar -->
  <div class="langbar">
    <span>ğŸŒ</span>
    <select onchange="changeLang(this.value)">
      <option value="en">English</option>
      <option value="hi">à¤¹à¤¿à¤‚à¤¦à¥€</option>
      <option value="pa">à¨ªà©°à¨œà¨¾à¨¬à©€</option>
      <option value="mr">à¤®à¤°à¤¾à¤ à¥€</option>
      <option value="ta">à®¤à®®à®¿à®´à¯</option>
    </select>
  </div>

</div><!-- /page -->

<!-- Toast -->
<div id="toast"></div>

<!-- Success overlay -->
<div id="overlay">
  <div class="ok-card">
    <span class="ok-icon">âœ…</span>
    <h3 id="ok-title">Success!</h3>
    <p  id="ok-desc">Redirecting to your dashboardâ€¦</p>
    <div class="prog"><div class="progfill" id="progfill"></div></div>
  </div>
</div>

<script>
/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   SLIDESHOW ENGINE
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
const SCENES = [
  'Golden Wheat Fields',
  'Paddy Farming',
  'Green Terraced Farmland',
  'Rich Farmland Rows',
  'Ripe Wheat Ears',
  'Seeds & Fertile Soil'
];
const INTERVAL = 6000;
let current = 0;

function initSlideshow() {
  const slides = document.querySelectorAll('.slide');
  const dotsEl = document.getElementById('dots');
  const labelEl = document.getElementById('scene-label');

  // Build dots
  SCENES.forEach((_, i) => {
    const d = document.createElement('button');
    d.className = 'dot' + (i===0 ? ' active' : '');
    d.setAttribute('aria-label', 'Scene '+(i+1));
    d.onclick = () => goTo(i);
    dotsEl.appendChild(d);
  });

  function goTo(n) {
    slides[current].classList.remove('active');
    dotsEl.children[current].classList.remove('active');
    current = (n + slides.length) % slides.length;
    slides[current].classList.add('active');
    dotsEl.children[current].classList.add('active');
    // Fade label
    labelEl.style.opacity = '0';
    setTimeout(() => {
      labelEl.textContent = SCENES[current];
      labelEl.style.opacity = '1';
    }, 400);
  }

  setInterval(() => goTo(current + 1), INTERVAL);
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   SIMULATED BACKEND API
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
const API = (() => {
  const KEY = 'kisanai_db';
  const db  = () => { try { return JSON.parse(localStorage.getItem(KEY)) || [] } catch { return [] } };
  const save = d => localStorage.setItem(KEY, JSON.stringify(d));
  const wait = ms => new Promise(r => setTimeout(r, ms));
  const hash = pw => { let h=0; for(let c of pw){ h=((h<<5)-h)+c.charCodeAt(0); h|=0 } return Math.abs(h).toString(16) };

  return {
    async login(id, pw, rem) {
      await wait(1100);
      const users = db();
      const u = users.find(u => u.phone===id || u.email===id.toLowerCase());
      if (!u)           return { ok:false, field:'id', msg:'No account found with this phone/email.' };
      if (u.pw!==hash(pw)) return { ok:false, field:'pw', msg:'Incorrect password. Please try again.' };
      const tok = btoa(JSON.stringify({ id:u.id, name:u.fn, exp: Date.now()+(rem?30:1)*86400000 }));
      (rem?localStorage:sessionStorage).setItem('ki_tok', tok);
      return { ok:true, name:u.fn };
    },
    async register(data) {
      await wait(1300);
      const users = db();
      if (users.find(u=>u.phone===data.phone))             return { ok:false, field:'ph', msg:'Phone already registered.' };
      if (data.email&&users.find(u=>u.email===data.email)) return { ok:false, field:'em', msg:'Email already registered.' };
      const id = 'F'+Date.now().toString(36).toUpperCase();
      users.push({ id, fn:data.fn, ln:data.ln, phone:data.phone, email:data.email, pw:hash(data.pw), state:data.state, crop:data.crop });
      save(users);
      return { ok:true, name:data.fn };
    },
    async forgot(id) {
      await wait(900);
      const u = db().find(u=>u.phone===id||u.email===id.toLowerCase());
      if (!u) return { ok:false, msg:'No account found with this phone/email.' };
      return { ok:true };
    },
    session() {
      const t = localStorage.getItem('ki_tok')||sessionStorage.getItem('ki_tok');
      if (!t) return null;
      try { const p=JSON.parse(atob(t)); return Date.now()<p.exp?p:null } catch { return null }
    }
  };
})();

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   UI HELPERS
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
let toastTimer;
function toast(msg, type='in', ms=3200) {
  const el = document.getElementById('toast');
  el.textContent = msg; el.className = 'show '+type;
  clearTimeout(toastTimer);
  toastTimer = setTimeout(() => el.className='', ms);
}

function showSuccess(title, desc) {
  document.getElementById('ok-title').textContent = title;
  document.getElementById('ok-desc').textContent  = desc;
  document.getElementById('overlay').classList.add('show');
  requestAnimationFrame(() => {
    const f = document.getElementById('progfill');
    f.style.width='0';
    requestAnimationFrame(() => f.style.width='100%');
  });
}

function setLoad(btnId, txtId, on, label='') {
  const b=document.getElementById(btnId), t=document.getElementById(txtId);
  b.disabled=on;
  t.innerHTML = on ? '<span class="spin">â³</span> Please waitâ€¦' : label;
}

function clearE(fid) {
  const f=document.getElementById('f-'+fid);
  if(f){f.classList.remove('err');const e=document.getElementById('e-'+fid);if(e)e.textContent=''}
}
function setE(fid, msg) {
  const f=document.getElementById('f-'+fid);
  if(f){f.classList.add('err');const e=document.getElementById('e-'+fid);if(e)e.textContent=msg}
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   TABS
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function show(tab) {
  ['login','register','forgot'].forEach(t=>{
    document.getElementById('p-'+t).classList.toggle('active',t===tab);
    const tb=document.getElementById('t-'+t);
    if(tb) tb.classList.toggle('active',t===tab);
  });
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   PASSWORD EYE
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function toggleEye(id, btn) {
  const i=document.getElementById(id);
  i.type=i.type==='password'?'text':'password';
  btn.textContent=i.type==='password'?'ğŸ‘ï¸':'ğŸ™ˆ';
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   STRENGTH
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function strength(pw) {
  const f=document.getElementById('sfill'), l=document.getElementById('slbl');
  const score=[pw.length>=8,/[A-Z]/.test(pw),/[0-9]/.test(pw),/[^A-Za-z0-9]/.test(pw),pw.length>=12].filter(Boolean).length;
  const lvl=[
    {p:'0',  c:'#d63c3c',t:''},
    {p:'20', c:'#d63c3c',t:'âš ï¸ Very Weak'},
    {p:'42', c:'#d97c20',t:'âš¡ Weak'},
    {p:'62', c:'#c9a020',t:'ğŸ”¶ Fair'},
    {p:'82', c:'#4e9e5e',t:'âœ… Strong'},
    {p:'100',c:'#176634',t:'ğŸ›¡ï¸ Very Strong'},
  ][score];
  f.style.width=lvl.p+'%';f.style.background=lvl.c;
  l.textContent=lvl.t;l.style.color=lvl.c;
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   VALIDATORS
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
const isId    = v => /^(\+91)?[6-9]\d{9}$/.test(v.replace(/\s/g,'')) || /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(v);
const isPhone = v => /^(\+91)?[6-9]\d{9}$/.test(v.replace(/[\s\-]/g,'')) || /^\+?\d{10,14}$/.test(v.replace(/\s/g,''));
const isEmail = v => !v || /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(v);

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   LOGIN
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
async function doLogin() {
  const id=document.getElementById('lg-id').value.trim();
  const pw=document.getElementById('lg-pw').value;
  const rm=document.getElementById('remember').checked;
  ['lg-id','lg-pw'].forEach(clearE);
  let ok=true;
  if(!id||!isId(id)){setE('lg-id','Enter a valid phone number or email.');ok=false}
  if(!pw)           {setE('lg-pw','Password is required.');ok=false}
  if(!ok) return;
  setLoad('btn-login','btl-txt',true);
  const r=await API.login(id,pw,rm);
  setLoad('btn-login','btl-txt',false,'Login');
  if(r.ok){
    showSuccess(`Welcome back, ${r.name}! ğŸŒ¾`,'Redirecting to your farming dashboardâ€¦');
    setTimeout(()=>{
      document.getElementById('overlay').classList.remove('show');
      toast('ğŸ‰ Demo: Would redirect to dashboard!','ok',4000);
    },3100);
  } else {
    setE('lg-'+(r.field==='id'?'id':'pw'), r.msg);
    toast('âŒ '+r.msg,'er');
  }
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   REGISTER
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
async function doRegister() {
  const fn=document.getElementById('rg-fn').value.trim();
  const ln=document.getElementById('rg-ln').value.trim();
  const ph=document.getElementById('rg-ph').value.trim();
  const em=document.getElementById('rg-em').value.trim();
  const st=document.getElementById('rg-st').value;
  const cr=document.getElementById('rg-cr').value;
  const pw=document.getElementById('rg-pw').value;
  const cp=document.getElementById('rg-cp').value;
  const tc=document.getElementById('terms').checked;
  ['rg-fn','rg-ph','rg-em','rg-st','rg-cr','rg-pw','rg-cp'].forEach(clearE);
  let ok=true;
  if(!fn)          {setE('rg-fn','First name is required.');ok=false}
  if(!isPhone(ph)) {setE('rg-ph','Enter a valid phone number.');ok=false}
  if(!isEmail(em)) {setE('rg-em','Enter a valid email address.');ok=false}
  if(!st)          {setE('rg-st','Please select your state.');ok=false}
  if(!cr)          {setE('rg-cr','Please select your primary crop.');ok=false}
  if(pw.length<8)  {setE('rg-pw','Password must be at least 8 characters.');ok=false}
  if(pw!==cp)      {setE('rg-cp','Passwords do not match.');ok=false}
  if(!tc)          {toast('âš ï¸ Please agree to Terms & Conditions.','er');ok=false}
  if(!ok) return;
  setLoad('btn-reg','btr-txt',true);
  const r=await API.register({fn,ln,phone:ph,email:em.toLowerCase(),state:st,crop:cr,pw});
  setLoad('btn-reg','btr-txt',false,'Create Account');
  if(r.ok){
    showSuccess('Account Created! ğŸŒ±',`Welcome, ${r.name}! You can now login.`);
    setTimeout(()=>{
      document.getElementById('overlay').classList.remove('show');
      show('login');
      document.getElementById('lg-id').value=ph;
      toast('ğŸ‰ Account ready! Please login.','ok',4000);
    },3100);
  } else {
    const m={ph:'rg-ph',em:'rg-em'};
    if(m[r.field]) setE(m[r.field],r.msg);
    toast('âŒ '+r.msg,'er');
  }
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   FORGOT
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
async function doForgot() {
  const id=document.getElementById('fp-id').value.trim();
  clearE('fp-id');
  if(!isId(id)){setE('fp-id','Enter a valid phone or email.');return}
  setLoad('btn-fp','btf-txt',true);
  const r=await API.forgot(id);
  setLoad('btn-fp','btf-txt',false,'Send Reset Link');
  if(r.ok){toast('ğŸ“© Reset link sent! Check your phone/email.','ok',5000);setTimeout(()=>show('login'),2600)}
  else    {setE('fp-id',r.msg);toast('âŒ '+r.msg,'er')}
}

function social(p){toast(`ğŸ”„ ${p} login â€” coming soon!`,'in')}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   LANGUAGE
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
const i18n={
  en:{t1:'Login',t2:'Register',wt:'Welcome back, Kisan ğŸ‘‹',ws:"Sign in to get today's farming advisory",jt:'Join KisanAI ğŸŒ±',js:'Create your free farmer account'},
  hi:{t1:'à¤²à¥‰à¤—à¤¿à¤¨',t2:'à¤°à¤œà¤¿à¤¸à¥à¤Ÿà¤°',wt:'à¤µà¤¾à¤ªà¤¸ à¤¸à¥à¤µà¤¾à¤—à¤¤ à¤¹à¥ˆ, à¤•à¤¿à¤¸à¤¾à¤¨ ğŸ‘‹',ws:'à¤¸à¤¾à¤‡à¤¨ à¤‡à¤¨ à¤•à¤°à¥‡à¤‚ à¤”à¤° à¤¸à¤²à¤¾à¤¹ à¤ªà¤¾à¤à¤‚',jt:'KisanAI à¤¸à¥‡ à¤œà¥à¤¡à¤¼à¥‡à¤‚ ğŸŒ±',js:'à¤…à¤ªà¤¨à¤¾ à¤¨à¤¿à¤ƒà¤¶à¥à¤²à¥à¤• à¤–à¤¾à¤¤à¤¾ à¤¬à¤¨à¤¾à¤à¤‚'},
  pa:{t1:'à¨²à©Œà¨—à¨‡à¨¨',t2:'à¨°à¨œà¨¿à¨¸à¨Ÿà¨°',wt:'à¨µà¨¾à¨ªà¨¸ à¨¸à©à¨†à¨—à¨¤, à¨•à¨¿à¨¸à¨¾à¨¨ ğŸ‘‹',ws:'à¨¸à¨¾à¨ˆà¨¨ à¨‡à¨¨ à¨•à¨°à©‹ à¨…à¨¤à©‡ à¨¸à¨²à¨¾à¨¹ à¨ªà©à¨°à¨¾à¨ªà¨¤ à¨•à¨°à©‹',jt:'KisanAI à¨¨à¨¾à¨² à¨œà©à©œà©‹ ğŸŒ±',js:'à¨†à¨ªà¨£à¨¾ à¨®à©à¨«à¨¼à¨¤ à¨–à¨¾à¨¤à¨¾ à¨¬à¨£à¨¾à¨“'},
  mr:{t1:'à¤²à¥‰à¤—à¤¿à¤¨',t2:'à¤¨à¥‹à¤‚à¤¦à¤£à¥€',wt:'à¤ªà¤°à¤¤ à¤¸à¥à¤µà¤¾à¤—à¤¤, à¤¶à¥‡à¤¤à¤•à¤°à¥€ ğŸ‘‹',ws:'à¤¸à¤¾à¤‡à¤¨ à¤‡à¤¨ à¤•à¤°à¤¾ à¤†à¤£à¤¿ à¤¸à¤²à¥à¤²à¤¾ à¤®à¤¿à¤³à¤µà¤¾',jt:'KisanAI à¤®à¤§à¥à¤¯à¥‡ à¤¸à¤¾à¤®à¥€à¤² à¤µà¥à¤¹à¤¾ ğŸŒ±',js:'à¤†à¤ªà¤²à¥‡ à¤®à¥‹à¤«à¤¤ à¤–à¤¾à¤¤à¥‡ à¤¤à¤¯à¤¾à¤° à¤•à¤°à¤¾'},
  ta:{t1:'à®‰à®³à¯à®¨à¯à®´à¯ˆ',t2:'à®ªà®¤à®¿à®µà¯',wt:'à®®à¯€à®£à¯à®Ÿà¯à®®à¯ à®µà®°à®µà¯‡à®±à¯à®•à®¿à®±à¯‹à®®à¯ ğŸ‘‹',ws:'à®‰à®³à¯à®¨à¯à®´à¯ˆà®¨à¯à®¤à¯ à®µà®¿à®µà®šà®¾à®¯ à®†à®²à¯‹à®šà®©à¯ˆ à®ªà¯†à®±à¯à®™à¯à®•à®³à¯',jt:'KisanAI à®‡à®²à¯ à®šà¯‡à®°à®µà¯à®®à¯ ğŸŒ±',js:'à®‰à®™à¯à®•à®³à¯ à®‡à®²à®µà®š à®•à®£à®•à¯à®•à¯ˆ à®‰à®°à¯à®µà®¾à®•à¯à®•à®µà¯à®®à¯'},
};
function changeLang(l) {
  const t=i18n[l]||i18n.en;
  document.getElementById('t-login').textContent=t.t1;
  document.getElementById('t-register').textContent=t.t2;
  document.querySelector('#p-login .form-title').textContent=t.wt;
  document.querySelector('#p-login .form-sub').textContent=t.ws;
  document.querySelector('#p-register .form-title').textContent=t.jt;
  document.querySelector('#p-register .form-sub').textContent=t.js;
  toast('ğŸŒ Language updated','in',1800);
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   INIT
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
document.addEventListener('DOMContentLoaded', () => {
  initSlideshow();

  // Keyboard submit
  ['lg-id','lg-pw'].forEach(id=>{
    document.getElementById(id)?.addEventListener('keydown', e=>{if(e.key==='Enter')doLogin()});
  });
  document.getElementById('fp-id')?.addEventListener('keydown', e=>{if(e.key==='Enter')doForgot()});
  ['rg-fn','rg-ln','rg-ph','rg-em','rg-pw','rg-cp'].forEach(id=>{
    document.getElementById(id)?.addEventListener('keydown', e=>{if(e.key==='Enter')doRegister()});
  });

  // Clear error on focus
  document.querySelectorAll('input,select').forEach(el=>{
    el.addEventListener('focus',()=>el.closest('.field')?.classList.remove('err'));
  });

  // Session check
  const s=API.session();
  if(s) toast(`ğŸ‘‹ Session active for ${s.name}. Welcome back!`,'ok',3500);
});
</script>
</body>
</html>